<!--
@license
Copyright (c) 2016 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
-->

<link rel="import" href="../../bower_components/polymer/polymer.html">
<link rel="import" href="../../bower_components/google-apis/google-maps-api.html">
<link rel="import" href="../../bower_components/app-localize-behavior/app-localize-behavior.html">
<link rel="import" href="../../bower_components/app-layout/app-scroll-effects/app-scroll-effects.html">
<link rel="import" href="../../bower_components/app-layout/app-drawer/app-drawer.html">
<link rel="import" href="../../bower_components/app-layout/app-drawer-layout/app-drawer-layout.html">
<link rel="import" href="../../bower_components/app-layout/app-header/app-header.html">
<link rel="import" href="../../bower_components/app-layout/app-header-layout/app-header-layout.html">
<link rel="import" href="../../bower_components/app-layout/app-box/app-box.html">
<link rel="import" href="../../bower_components/app-layout/app-toolbar/app-toolbar.html">
<link rel="import" href="../../bower_components/app-layout/app-scroll-effects/app-scroll-effects.html">
<link rel="import" href="../../bower_components/paper-toolbar/paper-toolbar.html">
<link rel="import" href="../../bower_components/paper-item/paper-item.html">
<link rel="import" href="../../bower_components/paper-card/paper-card.html">
<link rel="import" href="../../bower_components/paper-tabs/paper-tabs.html">
<link rel="import" href="../../bower_components/google-youtube/google-youtube.html">
<link rel="import" href="../../bower_components/iron-form/iron-form.html">
<link rel="import" href="../elements/label-autocomplete.html">
<link rel="import" href="../elements/page-footer.html">
<link rel="import" href="../elements/login-button.html">
<link rel="import" href="../shared-styles.html">
<link rel="import" href="../redux/actions/search-actions.html">
<link rel="import" href="../redux/global-store.html">
<dom-module id="main-view">
  <template>
    <style include="shared-styles">
      app-header-layout{
        background-image: url('/images/homepage/1.jpg');
        background-size: cover;
      }
      .first{
        height: 70vh;
        color: white;
      }
      .second{

        background-color: white;
      }
      div.feauture{
        height: 20vh;
      }
      .third{
        background-image: url('https://unsplash.it/1200/500?image=1002');
        background-size: cover;
        color:white;
        min-height: 40vh;
        padding-bottom: 3rem;
      }
      .third paper-material{
        background-color: white;
      }
      .last{
        height: 70vh;
        background-color: var(--default-primary-color);
        color: var(--light-primary-text-color);
      }
      .footer{
        height: 50vh;
        background-color: var(--dark-primary-color);
      }
      app-header {
        background-color: transparent;
        --app-header-background-rear-layer: {
          /* The header is blue when condensed */
          background-color: var(--dark-primary-color);
        };
      }
      div.feauture iron-icon{
        height: 50px;
        width: 50px;
        padding: 0 30px;
      }
      div#recaptcha{
        height: 100px;
      }
      paper-tab[link] a {
       @apply(--layout-horizontal);
       @apply(--layout-center-center);
       color: var(--light-primary-text-color);
       text-decoration: none;
      }
      paper-tabs{
        min-width:450px;
      }
      div.search-box {
        background-color: rgba(255, 255, 255, 0.6);
        width : 54%!important;
        padding-bottom: 2rem;
        padding-left: 2rem;
        padding-right: 2rem;
        min-width: 32rem !important;
        color : white;
      }
    </style>
    <app-location route="{{route}}"></app-location>
    <app-header-layout fullbleed>
      <app-header fixed reveals effects="fade-background">
        <app-toolbar>
            <iron-image height="50" width="50" src="/images/logo.png" preload sizing="cover"></iron-image>
            <div main-title><span class="text-display-2">Dinabun</span></div>
            <paper-tabs selected="[[route]]" attr-for-selected="route" align-bottom >
              <paper-tab link route="main">
                <a href="/main">Inicio</a>
              </paper-tab>
              <paper-tab link route="sytm">
                <a href="/sytm">Cómo funciona</a>
              </paper-tab>
              <paper-tab link route="opo">
                <a href="/opo">Oportunidades</a>
              </paper-tab>
              <paper-tab link route="abt">
                <a href="/abt">Sobre Nosotros</a>
              </paper-tab>
            </paper-tabs>
            <login-button></login-button>
        </app-toolbar>
      </app-header>
      <div>
        <section class="first">
          <div class="container-fluid h-100">
            <div class="row h-100">
              <div class="col-xs-12 col-sm-6 vertical center">
                <h3 class="text-center strong">Descubre un mundo de oportunidades</h3>
                <h4 class="text-center">Encuentra los recursos para avanzar en tu entorno.</h4>
                <div class="w-100 horizontal center">
                  <a href="/rgst"><paper-button raised class="accent">Empezar</paper-button></a>
                </div>
              </div>
            </div>
          </div>
        </section>
        <section class="second">
          <div class="container h-100 text-center">
            <div class="row">
              <div class="col-xs-12 vertical center flex mt-3">
                <h4>Mira lo que podemos hacer contigo</h4>
                <span class="light">Con tu ayuda, podemos ayudarte a ti y a todas las personas a tu alrededor.</span>
              </div>
            </div>
            <div class="row">
              <div class="col-xs-12 col-sm-12 col-md-4 vertical center feauture">
                <iron-icon icon="close"></iron-icon>
                <br>
                <span class="strong">Consigue empleo</span>
                <span class="light">Busca enrtre cientos de oportunidades de empleo esperándote para que apliques.</span>
              </div>
              <div class="col-xs-12 col-sm-12 col-md-4 vertical center feauture">
                <iron-icon icon="close"></iron-icon>
                <br>
                <span class="strong">Consigue empleo</span>
                <span class="light">Busca enrtre cientos de oportunidades de empleo esperándote para que apliques.</span>
              </div>
              <div class="col-xs-12 col-sm-12 col-md-4 vertical center feauture">
                <iron-icon icon="close"></iron-icon>
                <br>
                <span class="strong">Consigue empleo</span>
                <span class="light">Busca enrtre cientos de oportunidades de empleo esperándote para que apliques.</span>
              </div>
            </div>
            <div class="row mb-3">
              <div class="col-xs-12 vertical center flex" >
                <span class="light mt-3 ">Regístrate para empezar a recibir estos beneficios</span>
                <a href="/rgst"><paper-button raised class="primary my-1">Registrarme</paper-button></a>
              </div>
            </div>
          </div>
        </section>
        <section class="third">
          <google-maps-api version="3.exp" on-api-load="apiLoaded" api-key="AIzaSyAgHlheOp2U3v1xSDgxFOjyZvYiv7s63yY"></google-maps-api>
          <div class="container h-100">
            <div class="row h-100">
              <div class="col-12 col-md-8 push-md-2 col-lg-6 push-lg-3">
                <h3 class="text-center">Busca para empezar a emprender</h3>
                <span class="text-center">Encuentra una oportunidad de trabajo o una opción para invertir tu dinero. Crea conexiones, levántate con el éxito.</span>
              </div>
              <div class="col-12 vertical center">
                <paper-material elevation="1" class="px-3 mt-3 horizontal">
                  <paper-dropdown-menu label="Estás buscando...">
                    <paper-listbox class="dropdown-content" selected="{{params.type}}"  attr-for-selected="value">
                      <paper-item value="i">Inversiones</paper-item>
                      <paper-item value="d">Donaciones</paper-item>
                      <paper-item value="j">Trabajos</paper-item>
                    </paper-listbox>
                  </paper-dropdown-menu>
                  <paper-input label="En...(lugar)" id="placeInput" class="mx-1"></paper-input>
                  <paper-button raised class="accent self-center" on-tap="search">Buscar</paper-button>
                </paper-material>
              </div>
            </div>
          </div>
        </section>
        <section class="forth">
          <div class="container h-100">
            <div class="row">
              <div class="col-xs-12 vertical center flex py-2 ">
                <h4>Conoce a nuestro equipo</h4>
                <span class="light">Las personas que van a atender tus necesidades en este proceso</span>
              </div>
            </div>
            <div class="row pb-3 center">
              <div class="py-1 col-xs-12 col-sm-4 col-md-3 horizontal center">
                <paper-card image="//dummyimage.com/360x557/cccccc/949494.jpg">
                  <div class="card-content vertical center">
                    <span class="strong">Nombre numero 1</span>
                    <span class="light">Cargo del brow</span>
                  </div>
               </paper-card>
              </div>
              <div class="py-1 col-xs-12 col-sm-4 col-md-3 horizontal center">
                <paper-card image="//dummyimage.com/360x557/cccccc/949494.jpg">
                  <div class="card-content vertical center">
                    <span class="strong">Nombre numero 1</span>
                    <span class="light">Cargo del brow</span>
                  </div>
               </paper-card>
              </div>
              <div class="py-1 col-xs-12 col-sm-4 col-md-3 horizontal center">
                <paper-card image="//dummyimage.com/360x557/cccccc/949494.jpg">
                  <div class="card-content vertical center">
                    <span class="strong">Nombre numero 1</span>
                    <span class="light">Cargo del brow</span>
                  </div>
               </paper-card>
              </div>
            </div>
          </div>
        </section>
        <section class="last">
          <div class="container h-100 mt-2">
            <div class="row vertical">
              <div class="col-xs-12 horizontal center">
                <h4>Mira un video sobre nosotros</h4>
              </div>
              <div class="col-xs-12 col-sm-8 offset-sm-2 col-md-8 offset-md-2 flex">
                <paper-card class="h-100 w-100">
                  <div class="card-content">
                    <google-youtube
                      video-id="d0wC-Sm280w"
                      fluid
                      rel="0"
                      start="5">
                    </google-youtube>
                  </div>
                </paper-card>
              </div>
            </div>
          </div>
        </section>
        <section>
          <div class="container-fluid">
              <page-footer></page-footer>
          </div>
        </section>
      </div>
    </app-header-layout>
    <paper-toast id="toast" duration="5000" ></paper-toast>
  </template>

  <script>
    Polymer({
      is: 'main-view',

      behaviors : [
        Polymer.AppLocalizeBehavior,
        GlobalStoreBehavior,
        SearchActionsBehavior
      ],

      properties : {
        language : {
          type:String,
          statePath:'language'
        },
        user :{
          type : Object
        },
        route : {
          type : String
        },
        params: {
          type : Object,
          value: function(){
            return{
              type:null,
              place:null
            }
          }
        }
      },
      observers : [
        '_paramsChanged(params.*)',
      ],
      attached : function() {
        this.loadResources( this.resolveUrl('../locales/main-view.json'));
      },
      apiLoaded:function(){
        var googleMapsApiRestrictions = {
          type : Object,
          value : {types : ['(regions)'],componentRestrictions: {country: 'ec'}}
        };
        var input = this.$.placeInput.inputElement;
        var placeAutocomplete= new google.maps.places.Autocomplete(input,googleMapsApiRestrictions);
        google.maps.event.addListener(placeAutocomplete,'place_changed', ()=>{
          var city = placeAutocomplete.getPlace();
          if(!city.geometry){
            showMessage('No hemos encontrado ese lugar');
          }else{
            this.set('params.place',city.place_id);
          }
        });
      },
      _paramsChanged:function(params){
        this.dispatch('updateQuery',params.base);
      },
      search:function(){
        if(!this.params.type||!this.params.place){
          return showMessage('Debes seleccionar un lugar y un tipo de anuncio.');
        }
        this.dispatch('searchPosts');
        var route;
        switch (this.params.type) {
          case 'j':
            route='/srch/jobs';
            break;
          case 'i':
            route='/srch/investments';
            break;
          case 'd':
            route='/srch/donations';
            break;
        }
        route+='?type='+this.params.type+'&place='+this.params.place;
        window.history.pushState({}, null, route);
        window.dispatchEvent(new CustomEvent('location-changed'));
      }
    });
  </script>
</dom-module>
