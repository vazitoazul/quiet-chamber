<link rel="import" href="../../bower_components/polymer/polymer.html">
<link rel="import" href="../../bower_components/paper-card/paper-card.html">
<link rel="import" href="../../bower_components/app-localize-behavior/app-localize-behavior.html">
<link rel="import" href="../../bower_components/paper-icon-button/paper-icon-button.html">
<link rel="import" href="../../bower_components/app-localize-behavior/app-localize-behavior.html">
<link rel="import" href="../shared-styles.html">
<link rel="import" href="../elements/label-chip.html">
<link rel="import" href="../elements/label-element.html">
<link rel="import" href="../elements/account-postcard.html">
<link rel="import" href="../redux/global-store.html">
<dom-module id="business-card">
  <style include="app-grid-style shared-styles">
    .card-ligth {
      color: var(--paper-grey-600);
      font-size: 80%;
    }
    .posts {
      margin-top: 1rem;
      color: var(--paper-grey-600);
    }
    a.edit{
      position: relative
    }
  </style>
  <template>
    <label-element id="labelElement" on-labels-changed="_labelsChanged"></label-element>
    <template is="dom-if" if="[[complete]]">
      <paper-card image="http://tensaiweb.info/blog/wp-content/uploads/2016/05/Consejos-para-dise%C3%B1ar-un-logo-adecuado-para-tu-empresa.jpg">
        <div class="card-content ">
          <div class="card-header row">
            <h5>[[business.name]]</h5>
            <!-- <a href="/acco/business/[[business.id]]" class="col offset-sm-6"><paper-icon-button icon="create"></paper-icon-button></a> -->
          </div>
          <div><span class="card-ligth">[[localize('city')]]</span><h6>[[business.cityLabel]]</h6></div>
          <div><span class="card-ligth">[[localize('description')]]</span><h6>[[business.description]]</h6></div>
          <div><span class="card-ligth">[[localize('telephones')]]</span><h6>[[business.telephones.0]]</h6><h6>[[business.telephones.1]]</h6></div>
          <div class="card-ligth">[[localize('labels')]]</div>
          <div class="labels row">
            <template is="dom-repeat" items="[[businessLabels]]">
              <span class="col">[[item.text]]</span>
            </template>
          </div>
        </div>
        <div class="card-actions">
          <a href="/acco/business/[[business.id]]"><paper-button class="primary">[[localize('edit')]]</paper-button></a>
        </div>
      </paper-card>
        <div class="posts">[[localize('posts')]]</div>
        <div class="row">
          <template is="dom-repeat" items="[[business.posts]]">
            <account-postcard post="[[item]]" class="col-sm-6"></account-postcard>
          </template>
        </div>
    </template>
    <template is="dom-if" if="[[!complete]]">
      <paper-card class="col-sm-12">
        <div class="card-content row">
          <div class="card-header row col-sm-12">
            <h5>[[business.name]]</h5>
            <a href="/acco/business/[[business.id]]" class="edit"><paper-icon-button icon="create"></paper-icon-button></a>
          </div>
          <div class="col">
            <div><span class="card-ligth">[[localize('city')]]</span><h6>[[business.cityLabel]]</h6></div>
            <div><span class="card-ligth">[[localize('description')]]</span><h6>[[business.description]]</h6></div>
          </div>
          <div class="col">
            <div><span class="card-ligth">[[localize('telephones')]]</span><h6>[[business.telephones.0]]</h6><h6>[[business.telephones.1]]</h6></div>
            <div class="card-ligth">[[localize('labels')]]</div>
            <div class="labels row">
              <template is="dom-repeat" items="[[businessLabels]]">
                <span class="col">[[item.text]]</span>
              </template>
            </div>
          </div>
        </div>
      </paper-card>
    </template>
  </template>
  <script>
    Polymer({
      is: 'business-card',

      behaviors : [
        Polymer.AppLocalizeBehavior,
        GlobalStoreBehavior
      ],

      properties : {
        item : {
          type : Object,
          value : {}
        },
        complete : {
          type : Boolean,
          value : false
        },
        business : {
          type : Object,
        },
        businessLabels:{
          type : Array
        },
        language:{
          type:String,
          statePath:'language'
        },
        resources : {
          value :  function(){
            return  {
              'en' : {
                'name' : 'name',
                'city' : 'city',
                'labels' : 'labels',
                'telephones' : 'telephones',
                'number' : 'phone number {number}',
                'email' : 'Email',
                'mobile' : 'Mobile phone',
                'description' : 'description',
                'posts' : 'Posts',
                'edit' : 'Edit'
              } ,
              'es' : {
                'name' : 'nombre',
                'city' : 'ciudad',
                'labels' : 'etiquetas',
                'telephones' : 'teléfonos',
                'number' : 'Teléfono {number}',
                'email' : 'Correo electrónico',
                'mobile' : 'Teléfono celular',
                'description' : 'Descripccion',
                'posts' : 'Publicaciones',
                'edit' : 'Editar'
              }
            }
          }
        },
      },
      observers : [
        '_businessLabelsObserver(business.labels)'
      ],
      _labelsChanged : function(e){
        if(!this.business)return;
        this.set('businessLabels',this.$.labelElement.computeSelectedLabelsObjectArray(this.business.labels.slice(0),e.detail));
      },
      _businessLabelsObserver:function(labels){
        if(!labels)return;
        var labelElement = this.$.labelElement;
        this.set('businessLabels',labelElement.computeSelectedLabelsObjectArray(labels.slice(0),labelElement.labels));
      }
    });
  </script>
</dom-module>
