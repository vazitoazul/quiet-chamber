<!-- <link rel="import" href="../../bower_components/polymer/polymer.html">
<link rel="import" href="../../bower_components/app-storage/app-localstorage/app-localstorage-document.html">
<link rel="import" href="../../bower_components/iron-input/iron-input.html">
<link rel="import" href="../../bower_components/paper-button/paper-button.html">
<link rel="import" href="../../bower_components/paper-button/paper-button.html">
<link rel="import" href="../../bower_components/iron-collapse/iron-collapse.html">
<link rel="import" href="../../bower_components/app-localize-behavior/app-localize-behavior.html">
<link rel="import" href="../../bower_components/paper-menu/paper-menu.html">
<dom-module id="paper-autocomplete">
    <style>
    iron-collapse {
        box-shadow: 6px;
    }

    paper-button {
        width: 100%;
        text-transform: none;
    }
    </style>
    <template>
    	<app-localstorage-document key="langauge" data="{{language}}"></app-localstorage-document>
        <paper-input-container>
            <label>[[localize('label')]]</label>
            <content select=".content"></content>
            <input id="searchBox" class="paper-input-input" is="iron-input" bind-value="{{searchValue::input}}"></input>
        </paper-input-container>
        <iron-collapse id="collapse">
            <paper-material>
                <div>
                    <template id="resultList" is="dom-repeat" items="{{choices}}" filter="_listFilter">
                        <paper-item>
                            <paper-button on-tap="_selectItem">{{item.name}}</paper-button>
                        </paper-item>
                    </template>
                </div>
            </paper-material>
        </iron-collapse>
    </template>
</dom-module>
<script>
    Polymer({
        is: "paper-autocomplete",

    	behaviors : [
			Polymer.AppLocalizeBehavior
		],

        properties: {
            choices: {
            	type : Array,
	            value: [
	            	{ "name" : "caca"},
	            	{ "name" : "pop"},
	            	{ "name" : "popeya"},
	            	{ "name" : "asdf"},
	            	{ "name" : "wer"},
	            	{ "name" : "yu"},
	            	{ "name" : "cachorapo"},
	            	{ "name" : "losdfocachopo"},
	            	{ "name" : "cachosisiloporo"},
	            	{ "name" : "asdfsdfacach"},
	            	{ "name" : "asdfcachsdf"},
	            	{ "name" : "cacachcaca"},
	            	{ "name" : "nbsdfcach"}
	            ]
	        },

            value: {
                type: Object,
            },
            searchValue: {
                type: String,
                value: '',
                observer: "_valueChanged"
            },

            resources : {
            	value : function(){
            		return  {
            			'en' : {
            				'label' : 'label'
            			},
            			'es' : {
            				'label' : 'categoria'
            			}
            		}
            	}
            },

            timeout : {
            	type : Boolean,
            	value : true
            }
        },

        ready: function() {
            this.$.resultList.render()
        },

        _valueChanged: function(e) {
        	console.log(e);
        	var self = this;
            var collapse = this.$.collapse

           	if(!this.timeout){
           		return;
           	}
           	this.timeout = true;

           	setTimeout(function(){
	            self.$.resultList.render()
	            if (e != '' && !collapse.opened) {
	                collapse.toggle()
	            } else
	            if (e == '' && collapse.opened) {
	                collapse.toggle()
	            }
	            this.timeout = false;
	       	},1000);
        },

        _listFilter: function(item) {
            return item.name.toLowerCase().includes(
                this.searchValue.toLowerCase()
            )
        },

        _selectItem: function(event) {
            var collapse = this.$.collapse;
            this.set('searchValue', event.model.item.name)
            this.set('value', event.model.item)
            collapse.toggle()
        }
    });
</script> -->
