<link rel="import" href="../../bower_components/polymer/polymer.html">
<link rel="import" href="../../bower_components/iron-ajax/iron-ajax.html">
<link rel="import" href="../../bower_components/iron-form/iron-form.html">
<link rel="import" href="../../bower_components/paper-button/paper-button.html">
<link rel="import" href="../../bower_components/paper-input/paper-input.html">
<link rel="import" href="../../bower_components/paper-toast/paper-toast.html">
<link rel="import" href="../../bower_components/paper-card/paper-card.html">
<link rel="import" href="../../bower_components/app-storage/app-localstorage/app-localstorage-document.html">
<link rel="import" href="../../bower_components/app-localize-behavior/app-localize-behavior.html">
<link rel="import" href="../../bower_components/paper-dropdown-menu/paper-dropdown-menu.html">
<link rel="import" href="../../bower_components/paper-listbox/paper-listbox.html">
<link rel="import" href="../../bower_components/paper-icon-button/paper-icon-button.html">
<link rel="import" href="../shared-styles.html">
<dom-module id="post-form">
  <style include="shared-styles">
  :host {
    display: block;
  }
  paper-toast{
    right: 0 !important;
    left: inherit !important;
  }
  paper-card{
    width: 100%
  }
  </style>
  <template>
    <app-localstorage-document key="langauge" data="{{language}}"></app-localstorage-document>
    <paper-card>
      <div class="card-content">
        <form is="iron-form" id="postForm" method="post" action="/form/handler">
          <div class="row">
            <paper-dropdown-menu label="[[localize('type')]]" class="col-sm-3">
              <paper-listbox id="paperList" class="dropdown-content" selected="{{post.type}}"  attr-for-selected="value">
                <paper-item value="f">[[localize('franchise')]]</paper-item>
                <paper-item value="d">[[localize('donation')]]</paper-item>
                <paper-item value="i">[[localize('investment')]]</paper-item>
                <paper-item value="j">[[localize('job')]]</paper-item>
                <paper-item value="a">[[localize('advertising')]]</paper-item>
              </paper-listbox>
            </paper-dropdown-menu>
            <paper-icon-button icon="close" class="offset-sm-6" on-tap="fireRemoveEvent"></paper-icon-button>
          </div>
          <paper-textarea label="[[localize('description')]]" name="description" value="{{post.description}}" required error-message="[[localize('add_description')]]"></paper-textarea>
          <template is="dom-if" if="[[franchise]]">
            [[localize('franchise')]]
          </template>
          <template is="dom-if" if="[[investment]]">
            [[localize('investment')]]
          </template>
          <template is="dom-if" if="[[donation]]">
            [[localize('donation')]]
          </template>
          <template is="dom-if" if="[[advertising]]">
            [[localize('advertising')]]
          </template>
          <template is="dom-if" if="[[job]]">
            [[localize('job')]]
          </template>
        </form>
      </div>
      <div class="card-actions">
        <template is="dom-if" if="[[creatingABusiness]]">
          <template is="dom-if" if="[[creating]]"><paper-button raised class="primary" on-click="submitForm">[[localize('create')]]</paper-button></template>
          <template is="dom-if" if="[[!creating]]"><paper-button raised class="primary" on-click="submitForm">[[localize('update')]]</paper-button></template>
        </template>
      </div>
    </paper-card>
  </template>
  <script>
    Polymer({
      is : 'post-form',

      behaviors : [
        Polymer.AppLocalizeBehavior
      ],

      properties : {
        post : {
          type : Object
        },
        creating : {
          type : Boolean,
          value : false
        },
        creatingABusiness : {
          type : Boolean,
          value : false
        },
        resources : {
          value :   function(){
              return {
                'en':{
                  'franchise' : 'franchise',
                  'type' : 'type',
                  'donation' : 'donation',
                  'advertising' : 'advertising',
                  'investment' : 'investment',
                  'job' : 'job',
                  'create' : 'Create',
                  'update' : 'Update',
                  'delete' : 'delete',
                  'description' : 'description',
                  'add_description' : 'must input the business description'
                },
                'es':{
                  'franchise' : 'franquicia',
                  'type' : 'tipo',
                  'donation' : 'donación',
                  'advertising' : 'publicidad',
                  'investment' : 'inverciones',
                  'job' : 'trabajo',
                  'create' : 'Crear',
                  'update' : 'Actualizar',
                  'delete' : 'borrar',
                  'description' : 'descripcion',
                  'add_description' : 'debes agregar una descripción'
                }
              }
          }
        },

      },

      observers : [
        '_onPostTypeChanged(post.type)'
      ],

      _onPostTypeChanged : function(type){
        console.log(type);
        this.set('franchise',false);
        this.set('donation',false);
        this.set('franchise',false);
        this.set('advertising',false);
        this.set('job',false);
        switch(type){
          case 'f':
            this.set('franchise',true);
          break;
          case 'i':
            this.set('investment',true);
          break;
          case 'd':
            this.set('donation',true);
          break;
          case 'a':
            this.set('advertising',true);
          break;
          case 'j':
            this.set('job',true);
          break;
        }
      },

      validateForm : function(){
        return this.$.postForm.validate();
      },

      fireRemoveEvent : function(){
        this.fire('remove',this.index);
      }
    });
  </script>
</dom-module>
